{{ $settingsGeneral := .Site.GetPage "/settings/general" -}}
{{ $settingsDesign := .Site.GetPage "/settings/design" -}}
{{ $settingsAuthor := .Site.GetPage "/settings/author" -}}

<feed xmlns="http://www.w3.org/2005/Atom">
  <generator uri="https://www.lernblog.ch" version="{{ .Site.Params.version }}">Lernblog</generator>
  <id>{{ .Permalink }}</id>
  <link href="{{ .Permalink }}" />
  {{- with .OutputFormats.Get "ATOM" }}
  {{ printf `<link href=%q rel="self" type=%q />` .Permalink .MediaType | safeHTML }}
  {{ end -}}
  <title>{{ $settingsGeneral.Title }}</title>
  <subtitle>{{ $settingsGeneral.Description }}</subtitle>
  <updated>{{ now.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</updated>
  <author>
    <name>{{ $settingsAuthor.Params.name }}</name>
    <email>{{ $settingsAuthor.Params.email }}</email>
    <uri>{{ $settingsAuthor.Params.image | default "/img/default-author.png" | absURL }}</uri>
  </author>
  <icon>{{ $settingsDesign.Params.icon | default "/img/default-favicon.png" | absURL }}</icon>
  <logo>{{ $settingsDesign.Params.logo | default "/img/default-logo.png" | absURL }}</logo>
  <link href="{{ $settingsDesign.Params.image | default "/img/default-image.png" | absURL }}" rel="enclosure" type="image/*" />
  {{- range where .Pages "Section" "posts" }}
  <entry>
    <id>{{ .Permalink }}</id>
    <link href="{{ .Permalink }}" />
    {{ `<title type="html"><![CDATA[` | safeHTML }}{{ .Title }}]]></title>
    {{ `<summary type="html"><![CDATA[` | safeHTML }}{{ if .Description }}{{ .Description }}{{ else }}{{ .Summary }}{{ end }}]]></summary>
    <published>{{ .Date.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</published>
    <updated>{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</updated>
    {{- range .Params.tags }}
    <category term="{{ . | urlize }}" label="{{ . }}" scheme="{{ path.Join "tag" ( . | urlize) | absURL }}" />
    {{- end }}
    <link href="{{ .Params.image | absURL }}" rel="enclosure" type="image/*" />
  </entry>
  {{- end }}
</feed>

  